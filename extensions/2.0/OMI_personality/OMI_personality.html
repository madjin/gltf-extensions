<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../table2.css" />
</head>
<body>
<h1 id="omi_personality">OMI_personality</h1>
<h2 id="contributors">Contributors</h2>
<p>Anthony Burchell, Individual Contributor</p>
<h2 id="status">Status</h2>
<p>Draft Specification</p>
<p>Open Metaverse interoperability Group Stage 1 proposal</p>
<h2 id="dependencies">Dependencies</h2>
<p>Written against the glTF 2.0 spec.</p>
<h2 id="overview">Overview</h2>
<p>The OMI_personality extension allows you to specify a personality for a glTF node representing a entity. This extension can be used in virtual worlds, where characters can have unique personalities, and interactions with them can be enhanced by providing additional information about their behavior and dialogue.</p>
<h2 id="example">Example</h2>
<p>To use the "OMI_personality" extension, you must first specify it in the extensionsUsed property of your glTF file.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="fu">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>    <span class="dt">&quot;extensionsUsed&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;OMI_personality&quot;</span><span class="ot">]</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="fu">}</span></span></code></pre></div>
<p>Next, apply the extension to a child node of the glTF file. The node's position and rotation data can be used to determine the location of the spawn point in the scene.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="fu">{</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>    <span class="dt">&quot;nodes&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>        <span class="fu">{</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>            <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;cat&quot;</span><span class="fu">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>            <span class="dt">&quot;extensions&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>                <span class="dt">&quot;OMI_personality&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>                    <span class="dt">&quot;agent&quot;</span><span class="fu">:</span> <span class="st">&quot;cat&quot;</span><span class="fu">,</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>                    <span class="dt">&quot;personality&quot;</span><span class="fu">:</span> <span class="st">&quot;#agent has a cheerful personality.&quot;</span><span class="fu">,</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>                    <span class="dt">&quot;defaultMessage&quot;</span><span class="fu">:</span> <span class="st">&quot;nya nya!&quot;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>                <span class="fu">}</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>            <span class="fu">}</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>        <span class="fu">}</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a>    <span class="ot">]</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a><span class="fu">}</span></span></code></pre></div>
<p>In the example above, the "OMI_personality" extension is applied to a node named "cat". The agent property is used to specify the type of agent associated with the node, in this case, it's a cat. The personality property describes the agent's personality, and the defaultMessage property is the message that the agent will send as a default.</p>
<h2 id="properties">Properties</h2>
<p>The <code>defaultMessage</code> parameter is optional. The <code>agent</code> and <code>personality</code> options are required and provide context about the avatars name and default personality description.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>agent</strong></td>
<td><code>string</code></td>
<td>The name of the agent or NPC.</td>
</tr>
<tr class="even">
<td><strong>personality</strong></td>
<td><code>string</code></td>
<td>A default description of the personality of the agent allowing clients to inject that context into language model logic.</td>
</tr>
<tr class="odd">
<td><strong>defaultMessage</strong></td>
<td><code>string</code></td>
<td>A default message for this agent to initialize with.</td>
</tr>
</tbody>
</table>
<h2 id="json-schema">JSON Schema</h2>
<p>The OMI_personality extension is defined by the following JSON schema:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="fu">{</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a>    <span class="dt">&quot;$schema&quot;</span><span class="fu">:</span> <span class="st">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="fu">,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>    <span class="dt">&quot;title&quot;</span><span class="fu">:</span> <span class="st">&quot;OMI_personality&quot;</span><span class="fu">,</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>    <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;An extension for the glTF format that defines a personality for a node and an endpoint where additional information can be queried.&quot;</span><span class="fu">,</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>    <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;object&quot;</span><span class="fu">,</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>    <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>        <span class="dt">&quot;agent&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>            <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>            <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;The name of the agent associated with the node.&quot;</span><span class="fu">,</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>            <span class="dt">&quot;maxLength&quot;</span><span class="fu">:</span> <span class="dv">128</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>        <span class="fu">},</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a>        <span class="dt">&quot;personality&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>            <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>            <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;A description of the agent&#39;s personality.&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>        <span class="fu">},</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>        <span class="dt">&quot;defaultMessage&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>            <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a>            <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;The default message that the agent will send on initialization.&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a>        <span class="fu">}</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a>    <span class="fu">},</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a>    <span class="dt">&quot;required&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;agent&quot;</span><span class="ot">,</span> <span class="st">&quot;personality&quot;</span><span class="ot">]</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a><span class="fu">}</span></span></code></pre></div>
<h2 id="implementation-details">Implementation Details</h2>
<p>The OMI_personality extension allows users to inject a unique personality into their virtual representations and adheres to a simple set of properties that aim to be compatible with lots of AI software to come. In the below example implementation, the data for personality is used to combine with the input from the user talking to the NPC. The final prompt is being sent to the OpenAI Davinci model to allow for completion of the agent's response.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>    <span class="co">// Request coming from three.js frontend that is querying this endpoint making a call to the GPT-3 model. Contains the Personality data embeded in the NPC file.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>    <span class="kw">const</span> data <span class="op">=</span> <span class="cf">await</span> request<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>    <span class="kw">let</span> prompt <span class="op">=</span> data<span class="op">.</span><span class="at">inputs</span><span class="op">.</span><span class="at">personality</span><span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a>    <span class="kw">let</span> prompt <span class="op">=</span> data<span class="op">.</span><span class="at">Input</span><span class="op">.</span><span class="at">personality</span><span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>    <span class="kw">let</span> finalPrompt <span class="op">=</span> prompt</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>        <span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">&#39;#speaker&#39;</span><span class="op">,</span> data<span class="op">.</span><span class="at">Input</span><span class="op">.</span><span class="at">Speaker</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>        <span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">&#39;#input&#39;</span><span class="op">,</span> data<span class="op">.</span><span class="at">Input</span><span class="op">.</span><span class="at">Input</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>        <span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">&#39;#agent&#39;</span><span class="op">,</span> data<span class="op">.</span><span class="at">Input</span><span class="op">.</span><span class="at">Agent</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>        <span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">&#39;#conversation&#39;</span><span class="op">,</span> data<span class="op">.</span><span class="at">Input</span><span class="op">.</span><span class="at">Conversation</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>        <span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">&#39;undefined</span><span class="sc">\n</span><span class="st">&#39;</span><span class="op">,</span><span class="st">&#39;&#39;</span> )<span class="op">.</span><span class="fu">replaceAll</span>(<span class="st">&#39;undefined&#39;</span><span class="op">,</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>        <span class="op">.</span><span class="fu">slice</span>(<span class="op">-</span><span class="dv">5000</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>    <span class="kw">const</span> token <span class="op">=</span> authorization<span class="op">.</span><span class="fu">split</span>(<span class="st">&#39; &#39;</span>)[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a>    <span class="kw">const</span> postData <span class="op">=</span> {</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a>        <span class="dt">prompt</span><span class="op">:</span> finalPrompt <span class="op">,</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a>        <span class="dt">max_tokens</span><span class="op">:</span> <span class="dv">500</span><span class="op">,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a>        <span class="dt">stop</span> <span class="op">:</span> [<span class="st">&quot;###&quot;</span>]<span class="op">,</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a>        <span class="dt">temperature</span><span class="op">:</span> <span class="fl">0.7</span><span class="op">,</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a>    }<span class="op">;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a>    <span class="co">// Make the first request to the Davinci model</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a>    <span class="kw">const</span> davinciResponse <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="st">&#39;https://api.openai.com/v1/engines/text-davinci-003/completions&#39;</span><span class="op">,</span> {</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a>        <span class="dt">method</span><span class="op">:</span> <span class="st">&#39;POST&#39;</span><span class="op">,</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a>        <span class="dt">headers</span><span class="op">:</span> {</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true"></a>            <span class="st">&#39;Content-Type&#39;</span><span class="op">:</span> <span class="st">&#39;application/json&#39;</span><span class="op">,</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true"></a>            <span class="st">&#39;Authorization&#39;</span><span class="op">:</span> <span class="vs">`Bearer </span><span class="sc">${</span>token<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true"></a>        }<span class="op">,</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true"></a>        <span class="dt">body</span><span class="op">:</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>(postData)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true"></a>    })<span class="op">;</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true"></a></span></code></pre></div>
<p>The final prompt in this examples follows a structure of:</p>
<pre><code>Agent is cheerful and always willing to help with programming tasks. They are an entity that lives in a virtual world always looking for new and intersting ways to help humans create content in the metaverse. 
Speaker: Hello agent! Tell me about yourself
Agent: 
</code></pre>
<p>The above example is a final prompt that is sent to OpenAI where the model completes what the "Agent:" would write to complete this conversation factoring in the personality data above the chat log.</p>
<p>In this example, the text is being passed back to the Three.js scene and rendered in the scene using a Text component.</p>
</body>
</html>
